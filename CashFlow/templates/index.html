{% extends 'base.html' %}

{% block title %}Транзакции ДДС - CashFlow Manager{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h2 text-primary">
            <i class="bi bi-list-ul me-2"></i>Транзакции ДДС
        </h1>
        <p class="text-muted">Управление движением денежных средств</p>
    </div>
    <button class="btn btn-primary btn-lg" onclick="loadTransactionForm()">
        <i class="bi bi-plus-circle me-2"></i>Новая транзакция
    </button>
</div>

<div class="row mb-4">
    <div class="col-md-3">
        <div class="card stat-card bg-primary text-white">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <h6 class="card-title">Всего транзакций</h6>
                        <h3 id="total-count" class="card-text">0</h3>
                    </div>
                    <i class="bi bi-receipt fs-1 opacity-50"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stat-card bg-success text-white">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <h6 class="card-title">Общий доход</h6>
                        <h3 id="total-income" class="card-text">0 ₽</h3>
                    </div>
                    <i class="bi bi-arrow-up-circle fs-1 opacity-50"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stat-card bg-danger text-white">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <h6 class="card-title">Общий расход</h6>
                        <h3 id="total-expense" class="card-text">0 ₽</h3>
                    </div>
                    <i class="bi bi-arrow-down-circle fs-1 opacity-50"></i>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3">
        <div class="card stat-card bg-info text-white">
            <div class="card-body">
                <div class="d-flex align-items-center">
                    <div class="flex-grow-1">
                        <h6 class="card-title">Баланс</h6>
                        <h3 id="total-balance" class="card-text">0 ₽</h3>
                    </div>
                    <i class="bi bi-wallet2 fs-1 opacity-50"></i>
                </div>
            </div>
        </div>
    </div>
</div>

{% include 'partials/_filters.html' %}

<div class="card shadow-sm">
    <div class="card-header bg-white">
        <h5 class="card-title mb-0">
            <i class="bi bi-table me-2"></i>Список транзакций
        </h5>
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover table-striped mb-0">
                <thead class="table-light">
                    <tr>
                        <th><i class="bi bi-calendar me-1"></i>Дата</th>
                        <th><i class="bi bi-tag me-1"></i>Статус</th>
                        <th><i class="bi bi-arrow-left-right me-1"></i>Тип</th>
                        <th><i class="bi bi-folder me-1"></i>Категория</th>
                        <th><i class="bi bi-folder2 me-1"></i>Подкатегория</th>
                        <th><i class="bi bi-currency-ruble me-1"></i>Сумма</th>
                        <th><i class="bi bi-chat me-1"></i>Комментарий</th>
                        <th><i class="bi bi-gear me-1"></i>Действия</th>
                    </tr>
                </thead>
                <tbody id="transactions-body">
                    <tr>
                        <td colspan="8" class="text-center py-5">
                            <div class="text-muted">
                                <i class="bi bi-inbox fs-1 d-block mb-2"></i>
                                Загрузка транзакций...
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="card-footer bg-white">
        <div class="d-flex justify-content-between align-items-center">
            <span class="text-muted" id="pagination-info">Показано 0 из 0 записей</span>
            <nav>
                <ul class="pagination mb-0" id="pagination">
                    <li class="page-item disabled">
                        <a class="page-link" href="#">Назад</a>
                    </li>
                    <li class="page-item active">
                        <a class="page-link" href="#">1</a>
                    </li>
                    <li class="page-item disabled">
                        <a class="page-link" href="#">Вперед</a>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="/static/js/transactions.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        loadTransactions();
        loadFilterOptions();
        updateStatistics();
    });
</script>
{% endblock %}